---
title: Math
subtitle: Probabilities
author: Wouter van Amsterdam
date: 2025-07-07
format: 
    #beamer:
        #aspectratio: 169
        #logo: umcu_blue.png
    #html:
        #toc: true
        #toc-depth: 2
        #number-sections: true
    revealjs:
        toc: false
        #theme: [default, umcu.scss]
        incremental: true
        width: 1920
        height: 1080
        logo: ../day2-scms/umcu_blue.png
        center: true
        include-before: [ '<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {enableAssistiveMml: false}});</script>']
execute:
    warning: false
    message: false
categories:
    - math
    - preporatory
---


# Marginal, Joint and Conditional probabilites

## Setup

Probability statements about *random events* $A$ and $B$

- $A$: patient dies ($A=1$)
- $B$: patient has cancer ($B=1$)


:::::{.fragment}

Say we have 100 patients, we can tabulate them according to their cancer status and whether they died or not.

|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    | 5    | 5     | 10  |
|   | has no cancer | 10   | 80    | 90  |
|   |               | 15   | 85    | 100 |

: joint probability table 

:::::

## Marginal probabilities

- *Marginal* probabilites concern probabilities of *one* random event, regardless of the other random event.
- We read these probabilities from the *margins* of the joint probability table.


::: {layout="[60,40]" layout-valign="center"}

::::{.fragment}
| statement | interpretation |
|----------|-----------------------------------|
| $P(A=1)$   | *marginal* probability that event $A$ occurs |
| $P(B=1)$   | *marginal* probability that event $B$ occurs |
::::

::::{.r-stack}

:::::{.fragment .fade-out}
|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    | 5    | 5     | 10  |
|   | has no cancer | 10   | 80    | 90  |
|   |               | 15   | 85    | 100 |

:::::

:::::{.fragment .fade-in-then-out}
|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    | | | |
|   | has no cancer | | | |
|   |               | 15   | 85    | 100 |
$P(A=1) = 15 / 100$
:::::

:::::{.fragment .fade-in-then-out}
|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    |     |      | 10  |
|   | has no cancer |    |     | 90  |
|   |               |    |     | 100 |
$P(B=1) = 10 / 100$
:::::

::::

:::

## Joint Probabilities

- A *joint* probability concerns the probability of two random events *jointly* occurring together.
- These are a based on a single cell in the joint probability table

::: {layout="[60,40]" layout-valign="center"}

::::{.fragment}
| statement | interpretation |
|----------|-----------------------------------|
| $P(A)$   | *marginal* probability that event $A$ occurs |
| $P(A=1,B=1)$ | *joint* probability of $A$ and $B$  |
::::

::::{.r-stack}

:::::{.fragment .fade-in-then-out}
|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    | 5    | 5     | 10  |
|   | has no cancer | 10   | 80    | 90  |
|   |               | 15   | 85    | 100 |
:::::

:::::{.fragment .fade-in-then-out}
|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    | 5    | | |
|   | has no cancer | | | |
|   |               | | | 100 |

$P(B=1,A=1) = 5 / 100$
:::::


::::

:::

## Conditional probabilites

- *Conditional* probabilities concern the probability of one random event given that another random event has occurred.
- e.g. *what is the probability that a patient dies ($A=1$) given that they have cancer ($B=1$)?*
- These are read from the joint probability table by looking in the row or column of the conditioning event.


::: {layout="[60,40]" layout-valign="center"}

::::{.fragment}
| statement | interpretation |
|----------|-----------------------------------|
| $P(A)$   | *marginal* probability that event $A$ occurs |
| $P(A,B)$ | *joint* probability of $A$ and $B$  |
| $P(A=1|B=1)$ | *conditional* probability of $A$ given $B$  |
::::

::::{.r-stack}

:::::{.fragment .fade-out}
|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    | 5    | 5     | 10  |
|   | has no cancer | 10   | 80    | 90  |
|   |               | 15   | 85    | 100 |

[- *marginal* $P(A=1) = 15/100$]{.non-incremental}

:::::

:::::{.fragment}
|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    | 5    | 5     | 10  |
|   | has no cancer |    |     |   |
|   |               |    |     |  |

[- *marginal* $P(A=1) = 15/100$]{.non-incremental}

[- *conditional* $P(A=1|B=1) = 5 / 10$]{.non-incremental}

:::::

::::

:::

::: {.fragment}

:::: {.callout-note}

## conditional probabilities require dividing by the denominator of the conditioning set

This is why we need *positivity* (as dividing by $0$ is not defined)

::::

:::

## Probability rules and identities

:::{layout="[60,40]"}

| statement | interpretation |
|----------|-----------------------------------|
| $P(A) = \sum_{b} P(A,B=b)$ | marginal is sum over joint |

:::::{.fragment}

|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    | 5    |     |   |
|   | has no cancer | 10   |     |   |
|   |               | 15   |     | 100 |

\begin{align}
    P(A=1) &= P(A=1,B=0) + P(A=1,B=1) \\
           &= 5/100 + 10/100 \\
           & = 15/100
\end{align}


:::::

:::

## Probability rules and identities

:::{layout="[60,40]"}

| statement | interpretation |
|----------|-----------------------------------|
| $P(A) = \sum_{b} P(A,B=b)$ | marginal is sum over joint |
| $P(A,B) = P(A|B)P(B)$ | product rule | 

:::::{.fragment}
|   |               | A    |       |     |
|---|---------------|------|-------|-----|
|   |               | dies | lives |     |
| B | has cancer    | 5    |     | 10 |
|   | has no cancer |    |     |   |
|   |               |    |     | 100 |

\begin{align}
    P(A=1,B=1) &= P(A=1|B=1)P(B=1) \\
               &= 5/10 * 10/100 \\
               & = 5/100
\end{align}


:::::

:::

## Probability rules and identities

| statement | interpretation |
|----------|-----------------------------------|
| $P(A) = \sum_{b} P(A,B=b)$ | marginal is sum over joint |
| $P(A,B) = P(A|B)P(B)$ | product rule | 
| $P(A|B) = \frac{P(A,B)}{P(B)}$ | conditional is joint over marginal (follows from product rule)| 

## Probability rules and identities

| statement | interpretation |
|----------|-----------------------------------|
| $P(A) = \sum_{b} P(A,B=b)$ | marginal is sum over joint |
| $P(A,B) = P(A|B)P(B)$ | product rule | 
| $P(A|B) = \frac{P(A,B)}{P(B)}$ | conditional is joint over marginal (follows from product rule)| 
| $P(A|C) = \sum_{b} P(A|B=b,C)P(B=b|C)$ | total expectation (consequence of marginal vs joint and product rule) |

## Marginal and conditional independence:

| statement | interpretation |
|----------|-----------------------------------|
| $P(A,B) = P(A)P(B)$ | (marginal) independence of $A$ and $B$| 

- knowing $A$ has no information on what to expect of $B$
- If I roll a die, the result of that die ($A$) has no information on the weather in the Netherlands ($B$)

## Marginal and conditional independence:

| statement | interpretation |
|----------|-----------------------------------|
| $P(A,B) = P(A)P(B)$ | (marginal) independence of $A$ and $B$| 
| $P(A,B|C) = P(A|C)P(B|C)$ | conditional independence of $A$ and $B$ given $C$| 
| $P(A|B,C) = P(A|C)$ | conditional independence of $A$ and $B$ given $C$| 

- $C$ has all the information that is shared between $A$ and $B$

## Conditional Independence in an example

::: {layout="[70,30]" layout-valign="center"}

- Charlie calls Alice and reads her script $C$, then she calls Bob and reads him the same
- A week later we ask Alice to repeat the story Charlie told her, she remembered $A$, a noisy version of $C$
- We ask Bob the same, he recounts $B$, a different noisy version of $C$
- Are $A$ and $B$ independent? No! $P(A,B) \neq P(A)P(B)$
  - If we learn $A$ from Alice, we can get a good guess about $B$ from Bob
- If we knew $C$, would hearing $A$ give use more information about $B$?
  - No, because all the shared information between $A$ and $B$ is explained by $C$, so:
  - $P(A,B) \neq P(A)P(B)$
  - $P(A,B|C) = P(A|C)P(B|C)$
- Variables can be marginally dependent but conditionally independent (and vice-versa)

![ABC](figs/ABC.png){width="100%"}

:::

## Assumption parlance {#sec-assumptions}

- necessary assumption:
  - A **must** hold for B to be true
- sufficient assumption:
  - B is always true when A holds
- strong assumption:
  - requires *strong* evidence, we'd rather not make these
- weak assumption:
  - requires *weak* evidence
- strong vs weak assumption are judged on relative terms
  - if assumption A is sufficient for B, B cannot be a stronger assumption that A

